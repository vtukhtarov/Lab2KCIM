## СПм-22-6, Тухтаров Владислав Борисович
### Лабораторна робота №**2**. Редагування імітаційних моделей у середовищі NetLogo

<br>

### Варіант 9, модель у середовищі NetLogo:
[Shepherds](http://www.netlogoweb.org/launch#http://www.netlogoweb.org/assets/modelslib/Sample%20Models/Biology/Shepherds.nlogo)

Поділити вівець на два різних стада, відповідно і пастухів на дві різні організації. Пастухи повинні збирати тільки "своїх" вівець. Додати відключаєму можливість збирати "чужих" вівець, які після потрапляння до нового стада змінюють свою приналежність.

<br>

### Внесені зміни у вихідну логіку моделі, за варіантом:

## Поділити вівець на два різних стада:
Додав можливість створювання двох видів агентів:

<pre>
breed [shepherds shepherd]
</pre>
Замінив на:
<pre>
breed [shepherds1 shepherd1]
breed [shepherds2 shepherd2]
</pre>

А список глобальних змінних був модифікований таким чином:

<pre>
  globals
[
  sheepless-neighborhoods   ;; у скількох сусідніх ділянках немає овець?
  herding-efficiency        ;; вимірює, наскільки добре пасуться вівці
  blue-herding-efficiency   ;; ефективність групування синіх овець
  red-herding-efficiency    ;; ефективність групування червоних овець
  blue-sheep                ;; кількість синіх овець
  red-sheep                 ;; кількість червоних овець
]
</pre>

Після того, як були створені два типи створюємих пастухів було вирішено додати можливість огородити територію окремих типів пастухів координатами:

<pre>
shepherds1-own
[
  carried-sheep
  found-herd?
  homex
  homey
]
shepherds2-own
[
  carried-sheep
  found-herd?
  homex
  homey
]
</pre>

Самі координати я вирішив задати у процедурі setup:

<pre>
set-default-shape shepherds1 "person"
set-default-shape shepherds2 "person"

create-shepherds1 num-red-shepherds
[
  set homex 15
  set homey 15
  set color red
  set size 1.5
  set carried-sheep nobody
  set found-herd? false
  setxy random-xcor random-ycor 
]

create-shepherds2 num-blue-shepherds
[ 
  set homex -15
  set homey -15
  set color blue
  set size 1.5
  set carried-sheep nobody
  set found-herd? false
  setxy random-xcor random-ycor 
]
</pre>
Тепер при старті створюються два типа вівчарів - червоні та красні. Для червоних координати загону становлять (15,15), а для синіх - (-15, -15).

<br>

Були додані наступні елементи **setup**:

Важіль для кількості "красних" вівчарів на початку:

![Важіль червоних](lever-red.png)

Важіль для кількості "синіх" вівчарів на початку:

![Важіль синіх](lever-blue.png)

Були додані наступні елементи статистики:

Показник, що відображає поточну кількість "червоних" вівчарів:

![Показник червоних1](statistic-red1.png)

Показник, що відображає поточну кількість "синіх" вівчарів:

![Показник синіх1](statistic-blue1.png)

Показник, що відображає поточну кількість "червоних" вівчарів:

![Показник червоних2](statistic-red2.png)

Показник, що відображає поточну кількість "синіх" овець:

![Показник синіх2](statistic-blue2.png)

<br>

Через те, що тепер у вівчарів є загони - їм була створена нова логіка для "переносу" овець:

<pre>
ask shepherds1
  [ 
    ifelse carried-sheep = nobody
    [ 
      ifelse sqrt(((homex - xcor) ^ 2) + ((homey - ycor) ^ 2)) > 5
      [search-for-sheep]
      [
        wiggle
        fd 1
      ]
    ]
    [ 
      ifelse found-herd?
      [ find-empty-spot ]
      [ find-new-herd ] 
    ]
    if carried-sheep != nobody
    [ ask carried-sheep [ move-to myself ] ] 
  ]
</pre>
У кінці процедри підраховуються кількості овець
<pre>
set blue-sheep count sheep with [color = blue]
set red-sheep count sheep with [color = red]
</pre>

Логіка такова, що пастух тепер шукає вівцю при умові, що він на відстані 55 ділянок від загону та не несе іншу вівцю. Окрім того після знаходження та підбору вівці - вівчар несе вівцю до загону та залишає на вільному місці.

А вже через те, що у симуляції є два типи загонів та відповідно два типи вівчарів було вирішено ставити вівцям, що були підібрані клеймо того кольору, який тип вівчара її підібрав.
Окрім того була створена процедура, яка дозволює пастуху оцінювати вівцю та з деяким шансом він не підбере(або підбере) вівцю з протилежним клеймом:

<pre>
to search-for-sheep
  wiggle
  fd 1
  let personal-color color
  set carried-sheep one-of sheep-here with [not hidden? and (color = personal-color or color = white or (random 99) + 1 <= steal-chanse)]
  if (carried-sheep != nobody)
  [
    ask carried-sheep
    [ 
      set color personal-color
      hide-turtle
    ]
    fd 1 
  ]
end
</pre>

<br>

Були додані наступні елементи, що впливають під час роботи симуляції:

Важіль для налаштування ймовірності "кражі" вівці іншої команди:

![Важіль вора](lever-steal.png)

<br>

Скріншот роботи симуляції пістя внесених змін:

![Скрін1](screenshot1.png)

<br>


## Внесені зміни у вихідну логіку моделі, на власний розсуд:

Дивлячись на схожу модель **Fruit Wars** було вирішено додати пастухам можливість вбити пастуха з протилежної команди, мотивуючи це тим, що таким чином його команда зможе зібрати більше овець.

До процедури **to go** були додані наступні рядки:

<pre>
if count shepherds2-on neighbors >= gang-size and ((random 99) + 1 <= kill-chanse)
[
  print "red shepherd died"
  die
]
</pre>
Для додання шансу на вбивство у червоних.


<pre>
if count shepherds2-on neighbors >= gang-size and ((random 99) + 1 <= kill-chanse)
[
  print "red shepherd died"
  die
]
</pre>
Для додання шансу на вбивство у синіх.

<br>

Додано два відповідні важілі:

Важіль для налаштування шансу на вбивство:

![Важіль вбивство](lever-kill.png)

Важіль для налаштування мініммальної кількості "вбивць":

![Важіль вбивців](lever-gang.png)

<br>

Логіка вбивства була дещо змінена для уникнення плагіату та працює так:
Якщо вівчар, знаходячись на полі буде оточений **gang-size** кількістю вівчарів протилежного кольору, то у момент їх зустрічі розраховується **kill-chance** - шанс того, що вівчар буде вбитий, а у **Командний центр** виведено інформацію про смерть вівчара. При цьому вівця, яку ніс вівчар, таким чином становиться випадковою жертвою.

## Обчислювальний експеримент:

Зберігаючи одні й ті самі параметри досліджується поле з вівчарами та вівцями:
Експеримент проводиться з такими параметрами:
- **num-red-shepherds** 25
- **num-blue-shepherds** 25
- **num-sheep** 68
- **sheep-speed** 0.02
- **steal-chanse** 30
- **kill-chance** 30
- **gang-size** 8

Були підібрані усереднені результати симуляцій:

Скріншот1:

![Скріншот2](screenshot2.png)

Як можна побачити на скриншоті 1 - по проходженню 91742 тактів на полі залишилося 14 синіх вівчарів та 62 синіх вівці. 6 овець було випадково вбито у процесі захвату.

Скріншот2

![Скріншот3](screenshot3.png)

Як можна побачити на скриншоті 2 - по проходженню 12044 тактів на полі залишилося 6 червоних вівчарів та 59 червоних вівці. 9 овець було випадково вбито у процесі захвату.

<br>
